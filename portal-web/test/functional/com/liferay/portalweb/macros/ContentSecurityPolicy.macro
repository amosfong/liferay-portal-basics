definition {

	@summary = "Default summary"
	macro configureCSP(csp = null, enableCSP = null, excludedPaths = null) {
		if (${enableCSP} == "true") {
			FormFields.enableCheckbox(fieldName = "enabled");
		}
		else if (${enableCSP} == "false") {
			FormFields.disableCheckbox(fieldName = "enabled");
		}

		if (isSet(csp)) {
			Type(
				locator1 = "ContentSecurityPolicy#CONTENT_SECURITY_POLICY_TEXT",
				value1 = ${csp});
		}

		if (isSet(excludedPaths)) {
			Type(
				locator1 = "ContentSecurityPolicy#EXCLUDED_PATHS_TEXT",
				value1 = ${excludedPaths});
		}

		if (IsElementPresent(locator1 = "Button#UPDATE")) {
			PortletEntry.update();
		}
		else if (IsElementPresent(locator1 = "Button#SAVE")) {
			PortletEntry.save();
		}
	}

	@summary = "Default summary"
	macro deployInstanceConfigFile(portalInstanceName = null, osgiConfigFileName = null) {
		var companyId = JSONCompany.getCompanyId(portalInstanceName = ${portalInstanceName});

		AntCommands.runCommand("build-test-content-security-policy.xml", "prepare-content-security-policy-osgi-configuration -DcompanyId=${companyId} -Dosgi.config.file.name=${osgiConfigFileName}");
	}

	@summary = "Default summary"
	macro deploySiteConfigFile(osgiConfigFileName = null) {
		if (!(isSet(groupName))) {
			var groupName = "Guest";
		}

		var groupId = JSONGroupAPI._getGroupIdByName(
			groupName = ${groupName},
			site = "true");

		AntCommands.runCommand("build-test-content-security-policy.xml", "prepare-content-security-policy-osgi-site-configuration -DgroupId=${groupId} -Dosgi.config.file.name=${osgiConfigFileName}");
	}

	@summary = "Default summary"
	macro goToContentSecurityPolicyInstanceSettings() {
		if (!(isSet(baseURL))) {
			var baseURL = JSONCompany.getPortalURL();
		}

		Open(value1 = "${baseURL}/group/control_panel/manage?p_p_id=com_liferay_configuration_admin_web_portlet_InstanceSettingsPortlet&_com_liferay_configuration_admin_web_portlet_InstanceSettingsPortlet_factoryPid=com.liferay.portal.security.content.security.policy.internal.configuration.ContentSecurityPolicyConfiguration&_com_liferay_configuration_admin_web_portlet_InstanceSettingsPortlet_mvcRenderCommandName=%2Fconfiguration_admin%2Fedit_configuration");
	}

	@summary = "Default summary"
	macro goToContentSecurityPolicySiteSettings() {
		if (!(isSet(baseURL))) {
			var baseURL = JSONCompany.getPortalURL();
		}

		if (!(isSet(siteURLKey))) {
			var siteURLKey = "guest";
		}

		Open(value1 = "${baseURL}/group/${siteURLKey}/~/control_panel/manage/-/site/settings?_com_liferay_site_admin_web_portlet_SiteSettingsPortlet_factoryPid=com.liferay.portal.security.content.security.policy.internal.configuration.ContentSecurityPolicyConfiguration&_com_liferay_site_admin_web_portlet_SiteSettingsPortlet_mvcRenderCommandName=%2Fconfiguration_admin%2Fedit_configuration");
	}

	@summary = "Default summary"
	macro resetConfigureCSP() {
		if (isSet(reset)) {
			Click(locator1 = "Icon#HISTORY_VERTICAL_ELLIPSIS");

			MenuItem.clickNoError(menuItem = "Reset Default Values");
		}

		if (IsElementPresent(locator1 = "Button#UPDATE")) {
			PortletEntry.update();
		}
		else if (IsElementPresent(locator1 = "Button#SAVE")) {
			PortletEntry.save();
		}
	}

}