@component-name = "portal-frontend-infrastructure"
definition {

	property portal.release = "true";
	property portal.upstream = "true";
	property testray.component.names = "Clay";
	property testray.main.component.name = "Clay";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();

		task ("Add a site") {
			HeadlessSite.addSite(siteName = "Test Site Name");
		}

		task ("Add a widget page") {
			JSONLayout.addPublicLayout(
				groupName = "Test Site Name",
				layoutName = "Language Test Page Name");
		}

		task ("Add a Language Selector to page") {
			JSONLayout.addWidgetToPublicLayout(
				groupName = "Test Site Name",
				layoutName = "Language Test Page Name",
				widgetName = "Language Selector");
		}
	}

	tearDown {
		var testLiferayVirtualInstance = PropsUtil.get("test.liferay.virtual.instance");

		if (${testLiferayVirtualInstance} == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			JSONGroup.deleteGroupByName(groupName = "Test Site Name");
		}
	}

	@description = "LPS-142346 Verify that flag icons are present when clicking on localization button. Temporarily manually verify takescreenshot until we prove ocular can work in consistent and stable way."
	@priority = 5
	test FlagIconsCanRender {
		property portal.acceptance = "true";

		task ("Given language portlet") {
			Navigator.gotoSitePage(
				pageName = "Language Test Page Name",
				siteName = "Test Site Name");

			LanguagePortlet.selectLanguagePG(
				locale = "en-US",
				textIcon = "english-United States");
		}

		task ("When click on localization button") {
			Click(
				key_portletName = "LanguagePortlet",
				locator1 = "Language#DROPDOWN");
		}

		task ("Then flag icons are present on the button and dropdown menu items") {
			AssertElementPresent(
				key_flagID = "en-us",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "ar-sa",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "ca-es",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "zh-cn",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "nl-nl",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "fi-fi",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "fr-fr",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "de-de",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "hu-hu",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "ja-jp",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "pt-br",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "es-es",
				locator1 = "Icon#FLAG_SPECIFIC");

			AssertElementPresent(
				key_flagID = "sv-se",
				locator1 = "Icon#FLAG_SPECIFIC");

			takeScreenshot();
		}
	}

}